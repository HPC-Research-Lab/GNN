
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\appendix

\section{Appendix}

Our proposed method:
\begin{equation*}
\begin{split}
\boldsymbol{y}_{1}^{k+1}=&(1-\beta_k)\boldsymbol{y}_{1}^k+f_1(\boldsymbol{\theta}^k;\xi_1^k )-(1-\beta_k)f_1(\boldsymbol{\theta}^{k-1};\xi_1^k)\\
&-\prod_{j=k-t}^{k-1}(1-\beta_j)P(\xi_1^{k-t}/(\xi_1^{k-t+1}\cup\cdots \cup\xi_1^k))\boldsymbol{y}_1^{k-t+1}.
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
\boldsymbol{y}_{i}^{k+1}=&(1-\beta_k)\boldsymbol{y}_{i}^k+f_i(\boldsymbol{y}_{i-1}^{k+1};\xi_i^k )-(1-\beta_k)f_i(\boldsymbol{y}_{i-1}^{k};\xi_i^k)\\
&-\prod_{j=k-t}^{k-1}(1-\beta_j)P(\xi_i^{k-t}/(\xi_i^{k-t+1}\cup\cdots \cup\xi_i^k))\boldsymbol{y}_i^{k-t+1}\\
&(2\leq i\leq N-1).
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
\boldsymbol{\theta}^{k+1}=\boldsymbol{\theta}^k-\alpha_k\nabla f_1(\boldsymbol{\theta}^k;\xi_1^k)\cdots\nabla f_{N-1}(\boldsymbol{y}_{N-1}^{k+1};\xi_{N-2}^k)\nabla f_N(\boldsymbol{y}_{N-1}^{k+1};\xi_N^k).
\end{split}
\end{equation*}

Proof:Using the smoothness of $F(\boldsymbol{\theta}^k)$, we have

\begin{equation*}
\begin{split}
F(\boldsymbol{\theta}^{k+1})&\leq F(\boldsymbol{\theta}^k)+\left \langle \nabla F(\boldsymbol{\theta}^k),\boldsymbol{\theta}^{k+1}-\boldsymbol{\theta}^k \right \rangle+\frac{L}{2}\left \| \boldsymbol{\theta}^{k+1}-\boldsymbol{\theta}^k \right \|^2\\
&=F(\boldsymbol{\theta}^k)-\alpha_k\left \langle \nabla F(\boldsymbol{\theta}^k),\boldsymbol{\nabla}^k \right \rangle+\frac{L}{2}\left \| \boldsymbol{\theta}^{k+1}-\boldsymbol{\theta}^k \right \|^2\\
&=F(\boldsymbol{\theta}^k)-\alpha_k\left \| \nabla F(\boldsymbol{\theta}^k) \right \|^2+\frac{L}{2}\left \| \boldsymbol{\theta}^{k+1}-\boldsymbol{\theta}^k \right \|^2+\alpha_k\left \langle \nabla F(\boldsymbol{\theta}^k),\nabla F(\boldsymbol{\theta}^k)-\boldsymbol{\nabla}^k \right \rangle.
\end{split}
\end{equation*}

Conditioned on $\mathcal{F}$,taking expectation over$\xi_1,\cdot,\xi_N$,we have

\begin{equation*}
\begin{split}
&\mathbb{E}\left[ F\left(\boldsymbol{\theta}^{k+1}\right)|\mathcal{F}^k\right]\\
\leq &F(\boldsymbol{\theta}^k)-\alpha_k\left \| \nabla F(\boldsymbol{\theta}^k) \right \|^2+\frac{L}{2}\mathbb{E}\left [ \left \| \boldsymbol{\theta}^{k+1}-\boldsymbol{\theta}^k \right \|^2\mid \mathcal{F}^k \right ]+\alpha_k\left \langle \nabla F(\boldsymbol{\theta}^k),\mathbb{E}\left [\nabla F(\boldsymbol{\theta}^k)-\boldsymbol{\nabla}^k|\mathcal{F}^k \right ] \right \rangle\\
\overset{(b)}{\leq}&F(\boldsymbol{\theta}^k)-\alpha_k\left \| \nabla F(\boldsymbol{\theta}^k) \right \|^2+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2+\alpha_k\left \| \nabla F(\boldsymbol{\theta}^k) \right \|\left \| \mathbb{E}\left [ \boldsymbol{\nabla}^k|\mathcal{F}^k \right ]-\nabla F(\boldsymbol{\theta}^k)\right \|\\
\overset{(c)}{\leq}&F(\boldsymbol{\theta}^k)-\alpha_k\left \| \nabla F(\boldsymbol{\theta}^k) \right \|^2+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2+\alpha_k\sum_{n=1}^{N-1}A_n\left \| \nabla F(\boldsymbol{\theta}^k) \right \|\mathbb{E}\left [ \left \| \boldsymbol{y}_n^{k+1}-f_n(\boldsymbol{y}_{n-1}^{k+1})|\mathcal{F}^k \right \| \right ]\\
\overset{(d)}{\leq}&F(\boldsymbol{\theta}^k)-\alpha_k\left ( 1-\frac{\alpha_k}{2\beta_k}\sum_{n=1}^{N-1}A_n^2 \right )\left \| \nabla F(\boldsymbol{\theta}^k) \right \|^2+\frac{\beta_k}{2}\sum_{n=1}^{N-1}\mathbb{E}\left [\left \| \boldsymbol{y}_n^{k+1}-f_n(\boldsymbol{y}_{n-1}^{k+1}) \right \|^2|\mathcal{F}^k \right ]+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2.
\end{split}
\end{equation*}

where(b) uses the Cauchy-Schwartz;(c) follows from(60); and(d) used the Young's inequality.\\
The subsequent analysis for the multi-level problem builds on the following Lyapunov function:

\begin{equation*}
\begin{split}
\boldsymbol{w}^k:=F(\boldsymbol{\theta}^k)-F(\boldsymbol{\theta}^*)+\sum_{n=1}^{N-1}\left \| \boldsymbol{y}_n^k-f_n(\boldsymbol{y}_{n-1}^k) \right \|^2
\end{split}
\end{equation*}

where $\theta^*$ is the optional solution of the problem(1).

\begin{equation*}
\begin{split}
\mathbb{E}\left [ \boldsymbol{w}^{k+1}|\mathcal{F}^k \right ]\leq &\boldsymbol{w}^k-\alpha_k\left ( 1-\frac{\alpha_k}{2\beta_k}\sum_{i=1}^{N-1}A_n^2 \right )\left \| \nabla F\left ( \boldsymbol{\theta}^k \right ) \right \|^2+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2\\
&+(1+\beta_k)\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^{k+1}-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right \|^2 |\mathcal{F}^k \right ]-\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^{k}-f_i\left ( \boldsymbol{y}_{i-1}^{k} \right ) \right \|^2 |\mathcal{F}^k \right ]\\
&-\frac{\beta_k}{2}\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^{k+1}-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right \|^2 |\mathcal{F}^k \right ]\\
\leq & \boldsymbol{w}^k-\alpha_k\left ( 1-\frac{\alpha_k}{2\beta_k}\sum_{i=1}^{N-1}A_n^2 \right )\left \| \nabla F\left ( \boldsymbol{\theta}^k \right ) \right \|^2+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2\\
&+\left ( \left ( 1+\beta_k \right ) \left ( 1-\beta_k \right )-1 \right )\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^k-f_i(\boldsymbol{y}_{i-1}^k) \right \|^2|\mathcal{F}^k \right ]\\
&+4\left ( 1+\beta_k \right )(1-\beta_k)^2C_1^2\mathbb{E}\left [ \left \| \boldsymbol{\theta}^k-\boldsymbol{\theta}^{k-1} \right \|^2|\mathcal{F}^k \right ]\\
&+\sum_{i=2}^{N-1}\left [ 4\left ( 1+\beta_k \right )(1-\beta_k)^2C_i^2+r_i \right ]\mathbb{E}\left [ \left \| \boldsymbol{y}_{i-1}^{k+1}-\boldsymbol{y}_{i-1}^k \right \| |\mathcal{F}^k \right ]\\
&+2(1+\beta_k)\beta_k^2NV^2+\sum_{i=1}^{N-1}\frac{1+\beta_k}{\beta_k}\left ( 1-\beta_k \right )^{2t}\mathbb{E}\left \| \boldsymbol{u}_i^{k-t} \right \|^2\\
&-\sum_{i=2}^{N-1}r_i\mathbb{E}\left [ \left \| \boldsymbol{y}_{i-1}^{k+1}-\boldsymbol{y}_{i-1}^k \right \| |\mathcal{F}^k \right ]-\frac{\beta_k}{2}\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^{k+1}-f_i(\boldsymbol{y}_{i-1}^{k+1}) \right \|^2 \right ]\\
\leq & \boldsymbol{w}^k-\alpha_k\left ( 1-\frac{\alpha_k}{2\beta_k}\sum_{i=1}^{N-1}A_n^2 \right )\left \| \nabla F\left ( \boldsymbol{\theta}^k \right ) \right \|^2+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2+2(1+\beta_k)\beta_k^2NV^2+4C_1^2\mathbb{E}\left [ \left \| \boldsymbol{\theta}^k-\boldsymbol{\theta}^{k-1} \right \|^2|\mathcal{F}^k \right ]\\
&+\sum_{i=2}^{N-1}\left [ 4C_i^2+r_i \right ]\mathbb{E}\left [ \left \| \boldsymbol{y}_{i-1}^{k+1}-\boldsymbol{y}_{i-1}^{k} \right \|^2|\mathcal{F}^k \right ]\\
&-\sum_{i=2}^{N-1}r_i\mathbb{E}\left [ \left \| \boldsymbol{y}_{i-1}^{k+1}-\boldsymbol{y}_{i-1}^k \right \||\mathcal{F}^k \right ]-\frac{\beta_k}{2}\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^{k+1}-f_i(\boldsymbol{y}_{i-1}^{k+1}) \right \|^2 \right ]\\
&+\sum_{i=1}^{N-1}\frac{1+\beta_k}{\beta_k}(1-\beta_k)^{2t}\mathbb{E}\left \| \boldsymbol{u}_i^{k-t} \right \|^2\\
\leq & \boldsymbol{w}^k-\alpha_k\left ( 1-\frac{\alpha_k}{2\beta_k}\sum_{i=1}^{N-1}A_n^2 \right )\left \| \nabla F\left ( \boldsymbol{\theta}^k \right ) \right \|^2+\frac{L}{2}C_1^2\cdots C_N^2\alpha_k^2+2(1+\beta_k)\beta_k^2NV^2+4C_1^2\mathbb{E}\left [ \left \| \boldsymbol{\theta}^k-\boldsymbol{\theta}^{k-1} \right \|^2|\mathcal{F}^k \right ]\\
&+3\left ( \frac{\beta_k}{1-\beta_k} \right )^2\sum_{i=2}^{N-1}\left ( 4C_i^2+r_i \right )
\mathbb{E}\left \| \boldsymbol{y}_{i-1}^{k+1}-f_i\left ( \boldsymbol{y}_{i-2}^{k+1} \right ) \right \|^2-\frac{\beta_k}{2}\sum_{i=1}^{N-1}\mathbb{E}\left [ \left \| \boldsymbol{y}_i^{k+1}-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right \|^2 \right ]\\
&+3\sum_{i=2}^{N-1}\left ( 4C_i^2+r_i \right )L_{f_{i-1}}^2\mathbb{E}\left [ \left \| \boldsymbol{y}_{i-2}^{k+1}-\boldsymbol{y}_{i-2}^k \right \|^2|\mathcal{F}^k \right ]-\sum_{i=2}^{N-1}r_i\mathbb{E}\left [ \left \| \boldsymbol{y}_{i-1}^{k+1}-\boldsymbol{y}_{i-1}^k \right \||\mathcal{F}^k \right ]\\
&+\left ( 2\left ( 1+\beta_k \right )\beta_k^2N+3\left ( \frac{\beta_k}{1-\beta_k} \right )^2\sum_{i=2}^{N-1}\left ( 4C_i^2+r_i \right ) \right )V^2\\
&+\sum_{i=1}^{N-1}\frac{1+\beta_k}{\beta_k}\left ( 1-\beta_k \right )^{2t}\mathbb{E}\left \| \boldsymbol{u}_i^{k-t} \right \|^2+3\left ( 1-\beta_k \right )^{2t-2}\sum_{i=2}^{N-1}\left ( 4C_i^2+r_i \right )\mathbb{E}\left \| \boldsymbol{u}_{i-1}^{k-t} \right \|^2
\end{split}
\end{equation*}

And we have:

\begin{equation*}
\begin{split}
3\left ( \frac{\beta_k}{1-\beta_k} \right )^2\sum_{i=2}^{N-1}\left ( 4C_i^2+r_i \right )< \frac{\beta_k}{2}
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
3\sum_{i=2}^{N-1}\left ( 4C_i^2+r_i \right )L_{i-1}^2<r_{i-1}
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
\boldsymbol{y}_i^{k+1}&-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right )\\
=&\left ( 1-\beta_k \right )\left ( \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right )+\left ( 1-\beta_k \right )\left ( f_i\left ( \boldsymbol{y}_{i-1}^k\right )-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right ) \\
&+\beta_k\left ( f_i\left ( \boldsymbol{y}_{i-1}^{k+1};\xi_i^k \right )-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right )\\
&+\left ( 1-\beta_k \right )\left ( f_i\left ( \boldsymbol{y}_{i-1}^{k+1};\xi_i^k \right )-f_i\left ( \boldsymbol{y}_{i-1}^k;\xi_i^k \right ) \right )\\
&+\prod _{j=k-t}^{k-1}\left ( 1-\beta_j \right )P\left ( \xi_i^{k-t}/\left ( 
\xi_i^{k-t+1}\cup \cdots \cup\xi_i^k \right ) \right )\boldsymbol{y}_i^{k-t+1}\\
=&\left ( 1-\beta_k \right )\left ( \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right )+\left ( 1-\beta_k \right )T_1+\beta_kT_2+\left ( 1-\beta_k \right )T_3-\left ( 1-\beta_k \right )^tU_i^{k-T}
\end{split}
\end{equation*}

Conditioned on $\mathcal{F}^k$, taking expectation over $\xi_i^k$, we have:

\begin{equation*}
\begin{split}
E&\left [ \left ( 1-\beta_k \right )T_1+\beta_kT_2+\left ( 1-\beta_k \right )T_3 \right ]\\
&=E\left [ \left ( 1-\beta_k \right )f_i\left ( \boldsymbol{y}_{i-1}^k \right )-f_i\left ( \boldsymbol{y}_{i-1}^{k+1}\right )+f_i\left ( \boldsymbol{y}_i^{k+1};\xi_i^k  \right )-\left ( 1-\beta_k \right )f_i\left ( \boldsymbol{y}_{i-1}^k;\xi_i^k \right ) \right ]\\
&=0
\end{split}
\end{equation*}

Conditioned on $\mathcal{F}^{k,n}:=\left \{ \mathcal{F}^k,\boldsymbol{y}_1^{k+1},\cdots,\boldsymbol{y}_{i-1}^{k+1} \right \}$, taking expectation, we have:

\begin{equation*}
\begin{split}
E&\left [ \left \| \boldsymbol{y}_i^{k+1}-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right )\right \|^2 \right ]\\
&=E\left [ \left \| \left ( 1-\beta_k \right )\left ( \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right )-\left ( 1-\beta_k \right )^tU_i^{k-T} \right \|^2 \right ]\\
&\quad+E\left [ \left \| \left ( 1-\beta_k \right )T_1+\beta_kT_2+\left ( 1-\beta_k \right )T_3 \right \|^2 \right ]\\
&\leq\left ( 1-\beta_k \right )\left \| \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right \|^2+\frac{1}{\beta_k}\left ( 1-\beta_k \right )^{2t}\mathbb{E}\left [ \left \| U_i^{k-t} \right \|^2 \right ]\\
&\quad+2\mathbb{E}\left [ \left \| \left ( 1-\beta_k \right )T_1+\beta_kT_2 \right \|^2|\mathcal{F}^{k,n} \right ]+2\left ( 1-\beta_k \right )^2\mathbb{E}\left [ \left \| T_3 \right \|^2|\mathcal{F}^{k,n} \right ]\\
&\leq\left ( 1-\beta_k \right )\left \| \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right \|^2+2\left ( 1-\beta_k \right )^2\mathbb{E}\left [ \left \| T_1 \right \|^2|\mathcal{F}^{k,n} \right ]+2\beta_k^2\mathbb{E}\left [ \left \| T_2 \right \|^2|\mathcal{F}^{k,n} \right ]\\
&\quad+4\beta_k\left ( 1-\beta_k \right )\left \langle T_1,\mathbb{E}\left [ T_2|\mathcal{F}^{k,n} \right ] \right \rangle+2\left ( 1-\beta_k \right )^2\mathbb{E}\left [ \left \| T_3 \right \|^2|\mathcal{F}^{k,n} \right ]+\frac{1}{\beta_k}\left ( 1-\beta_k \right )^{2t}\mathbb{E}\left [ \left \| U_i^{k-t} \right \| \right ]\\
&\leq\left ( 1-\beta_k \right )\left \| \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right \|^2+2\left ( 1-\beta_k \right )^2\left \| f_i\left ( \boldsymbol{y}_{i-1}^k \right )-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right \|^2\\
&\quad+2\left ( 1-\beta_k \right )^2\mathbb{E}\left [ \left \| f_i\left ( \boldsymbol{y}_{i-1}^k;\xi_i^k \right )-f_i\left ( \boldsymbol{y}_{i-1}^{k+1};\xi_i^k \right ) \right \|^2 \right ]+2\beta_k^2V^2\\
&\quad+\frac{1}{\beta_k}\left ( 1-\beta_k \right )^{2t}\mathbb{E}\left [ \left \| U_i^{k-t} \right \|^2 \right ]\\
&\leq\left ( 1-\beta_k \right )\left \| \boldsymbol{y}_i^k-f_i\left ( \boldsymbol{y}_{i-1}^k \right ) \right \|^2\\
&\quad+4\left ( 1-\beta_k \right )^2C_i^2\left \| \boldsymbol{y}_{i-1}^k-\boldsymbol{y}_{i-1}^{k+1} \right \|^2+2\beta_k^2V^2\\
&\quad+\frac{1}{\beta_k}\left( 1-\beta_k \right )^2\mathbb{E}\left [ \left \| U_i^{k-t} \right \|^2 \right ]
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
\left ( 1-\beta_k \right )\left ( \boldsymbol{y}_i^{k+1}-\boldsymbol{y}_i^k \right )=&\beta_k\left ( f_i\left ( \boldsymbol{y}_{i-1}^{k+1};\xi_i^k \right )-\boldsymbol{y}_i^{k+1} \right )\\
&+\left ( 1-\beta_k \right )\left ( f_i\left ( \boldsymbol{y}_{i-1}^{k+1};\xi_i^k \right )-f_i\left ( \boldsymbol{y}_{i-1}^k;\xi_i^k \right ) \right )\\
&-\left ( 1-\beta_k \right )^tU_i^{k-t}
\end{split}
\end{equation*}

\begin{equation*}
\begin{split}
\mathbb{E}\left \| \boldsymbol{y}_i^{k+1}-\boldsymbol{y}_i^k \right \|^2\leq&3\left ( \frac{\beta_k}{1-\beta_k} \right )^2\mathbb{E}\left \| \boldsymbol{y}_i^{k+1}-f_i\left ( \boldsymbol{y}_{i-1}^{k+1} \right ) \right \|^2\\
&+3\left ( \frac{\beta_k}{1-\beta_k} \right )^2V^2+3L_{f_i}^2\mathbb{E}\left \| \boldsymbol{y}_{i-1}^{k+1}-\boldsymbol{y}_{i-1}^k \right \|^2\\
&+3\left ( 1-\beta_k \right )^{2(t-1)}\mathbb{E}\left \| U_i^{k-t} \right \|^2
\end{split}
\end{equation*}

Optionally include extra information (complete proofs, additional experiments and plots) in the appendix.
This section will often be part of the supplemental material.
